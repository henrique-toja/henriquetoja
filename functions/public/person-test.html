<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Teste Clínico de Personalidade - 105 Itens</title>
  <style>
    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      background: #f8fafc;
      color: #333;
      min-height: 100vh;
      display: flex;
      justify-content: center;
      align-items: center;
    }
    .container {
      max-width: 800px;
      margin: 0 auto;
      padding: 1rem;
      background: #fff;
      border-radius: 0.25rem;
      box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
    }
    .title {
      font-size: 1.5rem;
      font-weight: 600;
      text-align: center;
      margin-bottom: 1rem;
      color: #007bff;
    }
    .instructions {
      font-size: 1rem;
      line-height: 1.5;
      text-align: center;
      margin-bottom: 1.5rem;
    }
    .form-group {
      border: 1px solid #ced4da;
      border-radius: 0.25rem;
      padding: 1rem;
      margin-bottom: 1rem;
      background: #f8f9fa;
      animation: fadeIn 0.5s;
    }
    .form-group label {
      display: block;
      margin-bottom: 0.5rem;
      font-weight: 500;
    }
    .form-group .radio-options {
      display: flex;
      gap: 1rem;
      flex-wrap: wrap;
    }
    .form-group input[type="radio"] {
      display: none;
    }
    .form-group input[type="radio"] + label {
      padding: 0.5rem 1rem;
      border: 1px solid #ced4da;
      border-radius: 0.25rem;
      cursor: pointer;
      transition: background-color 0.2s;
    }
    .form-group input[type="radio"]:checked + label {
      background-color: #007bff;
      color: #fff;
    }
    .form-group input[type="radio"] + label:hover {
      background-color: #f1f1f1;
    }
    .btn {
      padding: 0.5rem 1rem;
      border-radius: 0.25rem;
      transition: background-color 0.2s;
      cursor: pointer;
      color: #fff;
    }
    .btn-secondary {
      background-color: #6c757d;
    }
    .btn-secondary:hover {
      background-color: #545b62;
    }
    .btn-primary {
      background-color: #007bff;
    }
    .btn-primary:hover {
      background-color: #0056b3;
    }
    .btn-success {
      background-color: #28a745;
    }
    .btn-success:hover {
      background-color: #1e7e34;
    }
    .btn:disabled {
      opacity: 0.5;
      cursor: not-allowed;
    }
    .table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 2rem;
    }
    .table th, .table td {
      padding: 0.75rem;
      text-align: left;
    }
    .table th {
      background-color: #f8f9fa;
      font-weight: 600;
    }
    .table tr {
      border-bottom: 1px solid #dee2e6;
    }
    .table tr:hover {
      background-color: #f1f1f1;
    }
    .alert {
      color: #dc3545;
      font-weight: 600;
      text-align: center;
      margin-top: 1rem;
    }
    .hidden {
      display: none;
    }
    .fade-in {
      animation: fadeIn 0.5s;
    }
    @keyframes fadeIn {
      from { opacity: 0; }
      to { opacity: 1; }
    }
    @media (max-width: 600px) {
      .container {
        padding: 0.5rem;
      }
      .btn {
        width: 100%;
        margin-bottom: 0.5rem;
      }
      .form-group .radio-options {
        flex-direction: column;
        gap: 0.5rem;
      }
    }
  </style>
</head>
<body>
  <div class="container">
    <h1 class="title">Teste Clínico de Personalidade</h1>
    <p class="instructions">Responda honestamente, de acordo com seu comportamento nos <b>últimos meses</b>. Não há respostas certas ou erradas. Use a escala abaixo para cada afirmação.</p>
    <form id="quizForm" class="space-y-6"></form>
    <div class="flex justify-between mt-8">
      <button id="prevBtn" type="button" class="btn btn-secondary" disabled>Anterior</button>
      <button id="nextBtn" type="button" class="btn btn-primary">Próximo</button>
      <button id="finishBtn" type="button" class="btn btn-success hidden">Finalizar teste</button>
    </div>
    <div id="resultSection" class="mt-10 hidden">
      <h2 class="title" style="color: #28a745;">Resultados</h2>
      <table class="table">
        <thead>
          <tr>
            <th>Traço de Personalidade</th>
            <th>Pontuação (0-100)</th>
          </tr>
        </thead>
        <tbody id="resultTableBody"></tbody>
      </table>
      <div id="controlWarn" class="alert hidden"></div>
    </div>
  </div>

  <script>
    // --- Blocos de perguntas revisadas (alternância positiva/negativa, frases objetivas) ---
    const traits = [
      {
        name: "Narcisista",
        questions: [
          "Gosto de receber elogios e reconhecimento pelo que faço.",
          "Acredito que minhas necessidades são mais importantes que as dos outros.",
          "Costumo me sentir superior à maioria das pessoas.",
          "Fico irritado se não sou o centro das atenções.",
          "Reconheço facilmente meus próprios méritos.",
          "Acho que mereço privilégios especiais.",
          "Tenho dificuldades em aceitar críticas sobre mim."
        ]
      },
      {
        name: "Antissocial",
        questions: [
          "Não vejo problema em quebrar regras para conseguir o que quero.",
          "Já menti ou enganei pessoas para benefício próprio.",
          "Me sinto pouco à vontade em respeitar autoridades.",
          "Tenho facilidade em manipular situações a meu favor.",
          "Raramente me arrependo de prejudicar alguém para atingir meus objetivos.",
          "Consigo agir friamente quando necessário.",
          "Costumo ignorar normas sociais quando acho conveniente."
        ]
      },
      {
        name: "Histriônico",
        questions: [
          "Gosto de chamar a atenção em rodas de conversa.",
          "Minha expressão emocional costuma ser intensa.",
          "Uso minha aparência para causar impacto nos outros.",
          "Posso ser considerado(a) dramático(a) por quem me conhece.",
          "Busco aprovação constante das pessoas ao meu redor.",
          "Me sinto desconfortável se não sou notado(a) em público.",
          "Tenho facilidade para influenciar as emoções dos outros."
        ]
      },
      {
        name: "Dependente",
        questions: [
          "Tenho dificuldade para tomar decisões sozinho(a).",
          "Preciso do apoio dos outros para iniciar projetos.",
          "Tenho medo de perder pessoas próximas.",
          "Evito conflitos para não desagradar quem gosto.",
          "Sinto insegurança ao agir sem orientação.",
          "Busco constantemente conselhos antes de agir.",
          "Cedo facilmente para manter a aprovação dos outros."
        ]
      },
      {
        name: "Sádico",
        questions: [
          "Já ri ou tirei sarro de alguém em situação constrangedora.",
          "Gosto de ter domínio sobre pessoas em situações cotidianas.",
          "Faço brincadeiras que podem humilhar outras pessoas.",
          "Já provoquei alguém apenas para ver sua reação.",
          "Me sinto satisfeito(a) ao ver alguém se dando mal em disputas.",
          "Já impus minha vontade usando ameaças ou intimidação.",
          "Exerço poder sobre pessoas mais frágeis sem culpa."
        ]
      },
      {
        name: "Compulsivo",
        questions: [
          "Me incomodo com ambientes desorganizados.",
          "Sigo rotinas rígidas no meu dia a dia.",
          "Tenho dificuldade em delegar tarefas a outras pessoas.",
          "Reviso frequentemente meu trabalho para evitar erros.",
          "Sou perfeccionista com minhas obrigações.",
          "Me adapto mal a mudanças inesperadas.",
          "Priorizar organização é mais importante que relaxar."
        ]
      },
      {
        name: "Negativista",
        questions: [
          "Costumo fazer o oposto do que esperam de mim.",
          "Reclamo de situações mesmo quando não são tão ruins.",
          "Dificilmente aceito ordens sem questionar.",
          "Perco a motivação facilmente quando pressionado(a).",
          "Resisto passivamente a tarefas impostas.",
          "Sinto raiva ao cumprir regras que considero injustas.",
          "Adio obrigações que me são impostas."
        ]
      },
      {
        name: "Esquivo",
        questions: [
          "Evito situações sociais por medo de rejeição.",
          "Me sinto desconfortável ao ser observado(a).",
          "Prefiro me isolar a correr riscos de crítica.",
          "Sinto receio ao iniciar conversas com desconhecidos.",
          "Acho que não sou bom o suficiente para certos grupos.",
          "Fujo de experiências sociais novas.",
          "Me preocupo excessivamente com opiniões negativas."
        ]
      },
      {
        name: "Depressivo",
        questions: [
          "Sinto falta de ânimo na maior parte dos dias.",
          "Tenho baixa autoestima e autocrítica frequente.",
          "Atividades que antes gostava perderam a graça.",
          "Me sinto desmotivado(a) sem razão aparente.",
          "Enxergo o futuro de forma pessimista.",
          "Tenho dificuldade em me conectar emocionalmente.",
          "Sinto um peso emocional constante."
        ]
      },
      {
        name: "Masoquista",
        questions: [
          "Aceito situações desconfortáveis para agradar os outros.",
          "Permaneço em relações onde sou desvalorizado(a).",
          "Costumo me autossabotar em momentos importantes.",
          "Sinto culpa ao buscar prazer ou reconhecimento.",
          "Evito me defender quando sou criticado(a).",
          "Acho que mereço sofrer por meus erros.",
          "Recuso boas oportunidades por achar que não sou merecedor(a)."
        ]
      },
      {
        name: "Borderline",
        questions: [
          "Tenho mudanças intensas de humor.",
          "Oscilo entre idealizar e desvalorizar pessoas próximas.",
          "Tenho medo intenso de ser abandonado(a).",
          "Sou impulsivo(a) diante de frustrações.",
          "Me envolvo em relações instáveis e intensas.",
          "Tenho dificuldade em controlar emoções.",
          "Às vezes sinto vazio e desesperança sem motivo."
        ]
      },
      {
        name: "Paranoico",
        questions: [
          "Desconfio das intenções das pessoas.",
          "Acredito que falam de mim pelas costas.",
          "Tomo precauções exageradas com minha privacidade.",
          "Interpreto comentários neutros como ameaças.",
          "Tenho dificuldade em confiar plenamente nos outros.",
          "Fico atento(a) a sinais de traição.",
          "Sinto necessidade constante de me proteger."
        ]
      },
      {
        name: "Esquizoide",
        questions: [
          "Prefiro atividades solitárias.",
          "Sinto pouca vontade de ter relações íntimas.",
          "Expressar emoções não faz parte do meu dia a dia.",
          "Sou indiferente a elogios e críticas.",
          "Tenho poucos amigos próximos.",
          "Não sinto falta de companhia.",
          "Demonstro pouco interesse por experiências sexuais com outros."
        ]
      },
      {
        name: "Esquizotípico",
        questions: [
          "Tenho crenças ou experiências incomuns.",
          "Às vezes percebo sinais ocultos em situações cotidianas.",
          "Minha forma de pensar é considerada excêntrica.",
          "Tenho dificuldade em manter conversas por sentir-me deslocado(a).",
          "Desconfio de coincidências, achando que têm significado especial.",
          "Minhas emoções são pouco compreendidas pelos outros.",
          "Me sinto diferente e isolado(a) da maioria."
        ]
      },
      {
        name: "Hipomaníaco",
        questions: [
          "Tenho períodos de energia incomum, mesmo dormindo pouco.",
          "Falo mais rápido ou mais do que o usual às vezes.",
          "Tomo decisões impulsivas quando estou animado(a).",
          "Busco iniciar novos projetos constantemente.",
          "Me envolvo em atividades de risco quando estou eufórico(a).",
          "Minha autoconfiança aumenta abruptamente em certos períodos.",
          "Tenho pensamentos acelerados e dificuldade para relaxar."
        ]
      }
    ];

    // Perguntas de controle para sinceridade/tendência (índices globais 35, 71, 98)
    const controlQuestions = [
      { idx: 35, text: "Responda 'Neutro' nesta afirmação para validar sua atenção.", trait: null },
      { idx: 71, text: "Sempre respondo perfeitamente a todos os testes que faço.", trait: null },
      { idx: 98, text: "Nunca omito a verdade, mesmo que isso me prejudique.", trait: null }
    ];

    const QUESTIONS_PER_PAGE = 7;
    const totalPages = Math.ceil((traits.length * QUESTIONS_PER_PAGE + controlQuestions.length) / QUESTIONS_PER_PAGE);
    let currentPage = 0;
    let answers = Array(traits.length * QUESTIONS_PER_PAGE + controlQuestions.length).fill(null);

    // Monta a lista de perguntas globalmente (inserindo controle)
    let allQuestions = [];
    let cIdx = 0, qIdx = 0;
    for (let t = 0; t < traits.length; t++) {
      for (let q = 0; q < QUESTIONS_PER_PAGE; q++) {
        if (cIdx < controlQuestions.length && (allQuestions.length === controlQuestions[cIdx].idx)) {
          allQuestions.push({ text: controlQuestions[cIdx].text, trait: null, isControl: true, globalIdx: allQuestions.length });
          cIdx++;
        }
        allQuestions.push({ text: traits[t].questions[q], trait: t, isControl: false, globalIdx: allQuestions.length });
        qIdx++;
      }
    }

    // Interface
    const form = document.getElementById('quizForm');
    const prevBtn = document.getElementById('prevBtn');
    const nextBtn = document.getElementById('nextBtn');
    const finishBtn = document.getElementById('finishBtn');
    const resultSection = document.getElementById('resultSection');
    const resultTableBody = document.getElementById('resultTableBody');
    const controlWarn = document.getElementById('controlWarn');

    // Renderiza perguntas da página atual
    function renderPage(page) {
      form.innerHTML = '';
      let startIdx = page * QUESTIONS_PER_PAGE;
      let isLastPage = (page === totalPages - 1);

      for (let i = 0; i < QUESTIONS_PER_PAGE; i++) {
        let qObj = allQuestions[startIdx + i];
        if (!qObj) continue;
        let qDiv = document.createElement('div');
        qDiv.className = 'form-group';
        let traitTag = qObj.trait !== null ? `<span style="color: #007bff; font-size: 0.75rem; font-weight: 600;">${traits[qObj.trait].name}</span>` : `<span style="color: #dc3545; font-size: 0.75rem; font-weight: 600;">Pergunta de Controle</span>`;
        qDiv.innerHTML = `<div class="flex justify-between items-center mb-2"><p>${qObj.globalIdx + 1}. ${qObj.text}</p>${traitTag}</div>`;
        let scaleDiv = document.createElement('div');
        scaleDiv.className = 'radio-options';
        for (let k = 1; k <= 5; k++) {
          let id = `q${qObj.globalIdx}_opt${k}`;
          let radio = document.createElement('input');
          radio.type = 'radio';
          radio.name = `q${qObj.globalIdx}`;
          radio.value = k;
          radio.id = id;
          if (answers[qObj.globalIdx] == k) radio.checked = true;
          let label = document.createElement('label');
          label.htmlFor = id;
          label.textContent = ["Discordo totalmente", "Discordo", "Neutro", "Concordo", "Concordo totalmente"][k - 1];
          scaleDiv.appendChild(radio);
          scaleDiv.appendChild(label);
        }
        qDiv.appendChild(scaleDiv);
        form.appendChild(qDiv);
      }
      prevBtn.disabled = page === 0;
      nextBtn.classList.toggle('hidden', isLastPage);
      finishBtn.classList.toggle('hidden', !isLastPage);
    }

    // Salva respostas da tela
    function savePageAnswers() {
      let startIdx = currentPage * QUESTIONS_PER_PAGE;
      for (let i = 0; i < QUESTIONS_PER_PAGE; i++) {
        let qObj = allQuestions[startIdx + i];
        if (!qObj) continue;
        let radios = document.getElementsByName(`q${qObj.globalIdx}`);
        for (let r of radios) {
          if (r.checked) {
            answers[qObj.globalIdx] = parseInt(r.value);
            break;
          }
        }
      }
    }

    // Verifica se página está completa
    function pageIsComplete() {
      let startIdx = currentPage * QUESTIONS_PER_PAGE;
      for (let i = 0; i < QUESTIONS_PER_PAGE; i++) {
        let qObj = allQuestions[startIdx + i];
        if (!qObj) continue;
        if (!answers[qObj.globalIdx]) return false;
      }
      return true;
    }

    // Navegação
    prevBtn.addEventListener('click', () => {
      savePageAnswers();
      if (currentPage > 0) {
        currentPage--;
        renderPage(currentPage);
      }
    });
    nextBtn.addEventListener('click', () => {
      savePageAnswers();
      if (!pageIsComplete()) {
        alert('Por favor, responda todas as perguntas antes de prosseguir.');
        return;
      }
      if (currentPage < totalPages - 1) {
        currentPage++;
        renderPage(currentPage);
      }
    });
    finishBtn.addEventListener('click', () => {
      savePageAnswers();
      if (!pageIsComplete()) {
        alert('Por favor, responda todas as perguntas antes de finalizar.');
        return;
      }
      showResults();
    });

    // Resultados
    function showResults() {
      form.classList.add('hidden');
      prevBtn.classList.add('hidden');
      nextBtn.classList.add('hidden');
      finishBtn.classList.add('hidden');
      resultSection.classList.remove('hidden');
      resultTableBody.innerHTML = "";

      // Cálculo médias dos traços
      for (let t = 0; t < traits.length; t++) {
        let idxs = [];
        for (let i = 0; i < allQuestions.length; i++) {
          if (allQuestions[i].trait === t) idxs.push(i);
        }
        let sum = 0;
        for (let i of idxs) sum += answers[i] || 0;
        let avg = ((sum - idxs.length) / (4 * idxs.length)) * 100; // 1-5 -> 0-100
        avg = Math.round(avg);
        let tr = document.createElement('tr');
        let td1 = document.createElement('td');
        td1.textContent = traits[t].name;
        let td2 = document.createElement('td');
        td2.textContent = avg;
        td2.style.textAlign = 'center';
        td2.style.fontWeight = '600';
        td2.style.color = '#007bff';
        tr.appendChild(td1);
        tr.appendChild(td2);
        resultTableBody.appendChild(tr);
      }

      // Validação das perguntas de controle
      let inconsistencies = [];
      if (answers[controlQuestions[0].idx] !== 3) inconsistencies.push("Atenção: Você marcou diferente de 'Neutro' na pergunta de controle 1.");
      if (answers[controlQuestions[1].idx] === 5) inconsistencies.push("Atenção: Você marcou 'Concordo totalmente' na pergunta de controle 2, o que pode indicar resposta socialmente desejável.");
      if (answers[controlQuestions[2].idx] === 5) inconsistencies.push("Atenção: Você marcou 'Concordo totalmente' na pergunta de controle 3, o que pode indicar resposta tendenciosa.");
      if (inconsistencies.length) {
        controlWarn.innerHTML = inconsistencies.join("<br>");
        controlWarn.classList.remove('hidden');
      }
    }

    renderPage(0);
  </script>
</body>
</html>