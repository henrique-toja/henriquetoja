<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Teste Clínico de Personalidade - 105 Itens</title>
  <link href="https://cdn.jsdelivr.net/npm/tailwindcss@3.4.1/dist/tailwind.min.css" rel="stylesheet">
  <style>
    html, body { background: #f8fafc; }
    .fade-in { animation: fadeIn .5s; }
    @keyframes fadeIn { from {opacity:0} to {opacity:1} }
  </style>
</head>
<body class="min-h-screen flex items-center justify-center px-2">
  <div class="w-full max-w-3xl bg-white rounded-2xl shadow-xl p-6 my-10 fade-in">
    <h1 class="text-3xl font-bold text-blue-700 text-center mb-2">Teste Clínico de Personalidade</h1>
    <p class="text-center text-gray-700 mb-4">Responda honestamente, de acordo com seu comportamento nos <b>últimos meses</b>. Não há respostas certas ou erradas. Use a escala abaixo para cada afirmação.</p>
    <div class="flex justify-center mb-6">
      <div class="w-full sm:w-2/3 flex flex-col gap-1">
        <div class="flex items-center gap-2 text-xs sm:text-sm justify-between">
          <span class="text-gray-600">1 - Discordo totalmente</span>
          <span class="text-gray-600">2</span>
          <span class="text-gray-600">3 - Neutro</span>
          <span class="text-gray-600">4</span>
          <span class="text-gray-600">5 - Concordo totalmente</span>
        </div>
      </div>
    </div>
    <form id="quizForm" class="space-y-6"></form>
    <div class="flex justify-between mt-8">
      <button id="prevBtn" type="button" class="px-6 py-2 bg-gray-200 text-gray-700 rounded hover:bg-gray-300 disabled:opacity-50 transition" disabled>Anterior</button>
      <button id="nextBtn" type="button" class="px-6 py-2 bg-blue-600 text-white rounded hover:bg-blue-700 transition">Próximo</button>
      <button id="finishBtn" type="button" class="px-6 py-2 bg-green-600 text-white rounded hover:bg-green-700 hidden transition">Finalizar teste</button>
    </div>
    <div id="resultSection" class="mt-10 hidden">
      <h2 class="text-2xl font-bold text-center text-green-600 mb-4">Resultados</h2>
      <div class="overflow-x-auto">
        <table class="min-w-full border border-gray-300 rounded bg-white shadow">
          <thead>
            <tr class="bg-blue-100">
              <th class="py-2 px-4 text-left">Traço de Personalidade</th>
              <th class="py-2 px-4 text-center">Pontuação (0-100)</th>
            </tr>
          </thead>
          <tbody id="resultTableBody"></tbody>
        </table>
      </div>
      <div id="controlWarn" class="mt-6 text-yellow-700 text-center font-bold hidden"></div>
    </div>
  </div>
<script>
// --- Blocos de perguntas revisadas (alternância positiva/negativa, frases objetivas) ---
const traits = [
  {
    name: "Narcisista",
    questions: [
      "Gosto de receber elogios e reconhecimento pelo que faço.",
      "Acredito que minhas necessidades são mais importantes que as dos outros.",
      "Costumo me sentir superior à maioria das pessoas.",
      "Fico irritado se não sou o centro das atenções.",
      "Reconheço facilmente meus próprios méritos.",
      "Acho que mereço privilégios especiais.",
      "Tenho dificuldades em aceitar críticas sobre mim."
    ]
  },
  {
    name: "Antissocial",
    questions: [
      "Não vejo problema em quebrar regras para conseguir o que quero.",
      "Já menti ou enganei pessoas para benefício próprio.",
      "Me sinto pouco à vontade em respeitar autoridades.",
      "Tenho facilidade em manipular situações a meu favor.",
      "Raramente me arrependo de prejudicar alguém para atingir meus objetivos.",
      "Consigo agir friamente quando necessário.",
      "Costumo ignorar normas sociais quando acho conveniente."
    ]
  },
  {
    name: "Histriônico",
    questions: [
      "Gosto de chamar a atenção em rodas de conversa.",
      "Minha expressão emocional costuma ser intensa.",
      "Uso minha aparência para causar impacto nos outros.",
      "Posso ser considerado(a) dramático(a) por quem me conhece.",
      "Busco aprovação constante das pessoas ao meu redor.",
      "Me sinto desconfortável se não sou notado(a) em público.",
      "Tenho facilidade para influenciar as emoções dos outros."
    ]
  },
  {
    name: "Dependente",
    questions: [
      "Tenho dificuldade para tomar decisões sozinho(a).",
      "Preciso do apoio dos outros para iniciar projetos.",
      "Tenho medo de perder pessoas próximas.",
      "Evito conflitos para não desagradar quem gosto.",
      "Sinto insegurança ao agir sem orientação.",
      "Busco constantemente conselhos antes de agir.",
      "Cedo facilmente para manter a aprovação dos outros."
    ]
  },
  {
    name: "Sádico",
    questions: [
      "Já ri ou tirei sarro de alguém em situação constrangedora.",
      "Gosto de ter domínio sobre pessoas em situações cotidianas.",
      "Faço brincadeiras que podem humilhar outras pessoas.",
      "Já provoquei alguém apenas para ver sua reação.",
      "Me sinto satisfeito(a) ao ver alguém se dando mal em disputas.",
      "Já impus minha vontade usando ameaças ou intimidação.",
      "Exerço poder sobre pessoas mais frágeis sem culpa."
    ]
  },
  {
    name: "Compulsivo",
    questions: [
      "Me incomodo com ambientes desorganizados.",
      "Sigo rotinas rígidas no meu dia a dia.",
      "Tenho dificuldade em delegar tarefas a outras pessoas.",
      "Reviso frequentemente meu trabalho para evitar erros.",
      "Sou perfeccionista com minhas obrigações.",
      "Me adapto mal a mudanças inesperadas.",
      "Priorizar organização é mais importante que relaxar."
    ]
  },
  {
    name: "Negativista",
    questions: [
      "Costumo fazer o oposto do que esperam de mim.",
      "Reclamo de situações mesmo quando não são tão ruins.",
      "Dificilmente aceito ordens sem questionar.",
      "Perco a motivação facilmente quando pressionado(a).",
      "Resisto passivamente a tarefas impostas.",
      "Sinto raiva ao cumprir regras que considero injustas.",
      "Adio obrigações que me são impostas."
    ]
  },
  {
    name: "Esquivo",
    questions: [
      "Evito situações sociais por medo de rejeição.",
      "Me sinto desconfortável ao ser observado(a).",
      "Prefiro me isolar a correr riscos de crítica.",
      "Sinto receio ao iniciar conversas com desconhecidos.",
      "Acho que não sou bom o suficiente para certos grupos.",
      "Fujo de experiências sociais novas.",
      "Me preocupo excessivamente com opiniões negativas."
    ]
  },
  {
    name: "Depressivo",
    questions: [
      "Sinto falta de ânimo na maior parte dos dias.",
      "Tenho baixa autoestima e autocrítica frequente.",
      "Atividades que antes gostava perderam a graça.",
      "Me sinto desmotivado(a) sem razão aparente.",
      "Enxergo o futuro de forma pessimista.",
      "Tenho dificuldade em me conectar emocionalmente.",
      "Sinto um peso emocional constante."
    ]
  },
  {
    name: "Masoquista",
    questions: [
      "Aceito situações desconfortáveis para agradar os outros.",
      "Permaneço em relações onde sou desvalorizado(a).",
      "Costumo me autossabotar em momentos importantes.",
      "Sinto culpa ao buscar prazer ou reconhecimento.",
      "Evito me defender quando sou criticado(a).",
      "Acho que mereço sofrer por meus erros.",
      "Recuso boas oportunidades por achar que não sou merecedor(a)."
    ]
  },
  {
    name: "Borderline",
    questions: [
      "Tenho mudanças intensas de humor.",
      "Oscilo entre idealizar e desvalorizar pessoas próximas.",
      "Tenho medo intenso de ser abandonado(a).",
      "Sou impulsivo(a) diante de frustrações.",
      "Me envolvo em relações instáveis e intensas.",
      "Tenho dificuldade em controlar emoções.",
      "Às vezes sinto vazio e desesperança sem motivo."
    ]
  },
  {
    name: "Paranoico",
    questions: [
      "Desconfio das intenções das pessoas.",
      "Acredito que falam de mim pelas costas.",
      "Tomo precauções exageradas com minha privacidade.",
      "Interpreto comentários neutros como ameaças.",
      "Tenho dificuldade em confiar plenamente nos outros.",
      "Fico atento(a) a sinais de traição.",
      "Sinto necessidade constante de me proteger."
    ]
  },
  {
    name: "Esquizoide",
    questions: [
      "Prefiro atividades solitárias.",
      "Sinto pouca vontade de ter relações íntimas.",
      "Expressar emoções não faz parte do meu dia a dia.",
      "Sou indiferente a elogios e críticas.",
      "Tenho poucos amigos próximos.",
      "Não sinto falta de companhia.",
      "Demonstro pouco interesse por experiências sexuais com outros."
    ]
  },
  {
    name: "Esquizotípico",
    questions: [
      "Tenho crenças ou experiências incomuns.",
      "Às vezes percebo sinais ocultos em situações cotidianas.",
      "Minha forma de pensar é considerada excêntrica.",
      "Tenho dificuldade em manter conversas por sentir-me deslocado(a).",
      "Desconfio de coincidências, achando que têm significado especial.",
      "Minhas emoções são pouco compreendidas pelos outros.",
      "Me sinto diferente e isolado(a) da maioria."
    ]
  },
  {
    name: "Hipomaníaco",
    questions: [
      "Tenho períodos de energia incomum, mesmo dormindo pouco.",
      "Falo mais rápido ou mais do que o usual às vezes.",
      "Tomo decisões impulsivas quando estou animado(a).",
      "Busco iniciar novos projetos constantemente.",
      "Me envolvo em atividades de risco quando estou eufórico(a).",
      "Minha autoconfiança aumenta abruptamente em certos períodos.",
      "Tenho pensamentos acelerados e dificuldade para relaxar."
    ]
  }
];

// Perguntas de controle para sinceridade/tendência (índices globais 35, 71, 98)
const controlQuestions = [
  { idx: 35, text: "Responda 'Neutro' nesta afirmação para validar sua atenção.", trait: null },
  { idx: 71, text: "Sempre respondo perfeitamente a todos os testes que faço.", trait: null },
  { idx: 98, text: "Nunca omito a verdade, mesmo que isso me prejudique.", trait: null }
];

const QUESTIONS_PER_PAGE = 7;
const totalPages = traits.length + controlQuestions.length; // 15 + 3 = 18 páginas
let currentPage = 0;
let answers = Array(traits.length * QUESTIONS_PER_PAGE + controlQuestions.length).fill(null);

// Monta a lista de perguntas globalmente (inserindo controle)
let allQuestions = [];
let cIdx = 0, qIdx = 0;
for (let t = 0; t < traits.length; t++) {
  for (let q = 0; q < QUESTIONS_PER_PAGE; q++) {
    if (cIdx < controlQuestions.length && (allQuestions.length === controlQuestions[cIdx].idx)) {
      allQuestions.push({ text: controlQuestions[cIdx].text, trait: null, isControl: true, globalIdx: allQuestions.length });
      cIdx++;
    }
    allQuestions.push({ text: traits[t].questions[q], trait: t, isControl: false, globalIdx: allQuestions.length });
    qIdx++;
  }
}

// Interface
const form = document.getElementById('quizForm');
const prevBtn = document.getElementById('prevBtn');
const nextBtn = document.getElementById('nextBtn');
const finishBtn = document.getElementById('finishBtn');
const resultSection = document.getElementById('resultSection');
const resultTableBody = document.getElementById('resultTableBody');
const controlWarn = document.getElementById('controlWarn');

// Renderiza perguntas da página atual (7 perguntas por página)
function renderPage(page) {
  form.innerHTML = '';
  let startIdx = page * QUESTIONS_PER_PAGE;
  let isLastPage = (page === totalPages - 1);
  let hasControl = false;

  for (let i = 0; i < QUESTIONS_PER_PAGE; i++) {
    let qObj = allQuestions[startIdx + i];
    if (!qObj) continue;
    let qDiv = document.createElement('div');
    qDiv.className = "mb-4 bg-gray-50 rounded p-4 shadow-sm fade-in";
    let traitTag = qObj.trait !== null ? `<span class="text-xs text-blue-600 font-semibold">${traits[qObj.trait].name}</span>` : `<span class="text-xs text-yellow-600 font-semibold">Pergunta de Controle</span>`;
    qDiv.innerHTML = `<div class="mb-2 flex justify-between items-center"><p class="font-medium text-gray-800">${qObj.globalIdx+1}. ${qObj.text}</p>${traitTag}</div>`;
    // Escala
    let scaleDiv = document.createElement('div');
    scaleDiv.className = "flex flex-wrap gap-3";
    for (let k = 1; k <= 5; k++) {
      let id = `q${qObj.globalIdx}_opt${k}`;
      let radio = document.createElement('input');
      radio.type = 'radio';
      radio.name = `q${qObj.globalIdx}`;
      radio.value = k;
      radio.id = id;
      radio.className = "hidden peer";
      if (answers[qObj.globalIdx] == k) radio.checked = true;
      let label = document.createElement('label');
      label.htmlFor = id;
      label.className = "px-3 py-1 rounded cursor-pointer border font-medium text-sm transition-colors peer-checked:bg-blue-600 peer-checked:text-white peer-checked:ring-2 peer-checked:ring-blue-300 bg-white text-gray-700 border-gray-300 hover:bg-blue-50";
      label.textContent = [
        "Discordo totalmente",
        "Discordo",
        "Neutro",
        "Concordo",
        "Concordo totalmente"
      ][k-1];
      scaleDiv.appendChild(radio);
      scaleDiv.appendChild(label);
    }
    qDiv.appendChild(scaleDiv);
    form.appendChild(qDiv);
    if (qObj.isControl) hasControl = true;
  }
  prevBtn.disabled = page === 0;
  nextBtn.classList.toggle('hidden', isLastPage);
  finishBtn.classList.toggle('hidden', !isLastPage);
}

// Salva respostas da tela
function savePageAnswers() {
  let startIdx = currentPage * QUESTIONS_PER_PAGE;
  for (let i = 0; i < QUESTIONS_PER_PAGE; i++) {
    let qObj = allQuestions[startIdx + i];
    if (!qObj) continue;
    let radios = document.getElementsByName(`q${qObj.globalIdx}`);
    for (let r of radios) {
      if (r.checked) {
        answers[qObj.globalIdx] = parseInt(r.value);
        break;
      }
    }
  }
}

// Verifica se página está completa
function pageIsComplete() {
  let startIdx = currentPage * QUESTIONS_PER_PAGE;
  for (let i = 0; i < QUESTIONS_PER_PAGE; i++) {
    let qObj = allQuestions[startIdx + i];
    if (!qObj) continue;
    if (!answers[qObj.globalIdx]) return false;
  }
  return true;
}

// Navegação
prevBtn.addEventListener('click', () => {
  savePageAnswers();
  if (currentPage > 0) {
    currentPage--;
    renderPage(currentPage);
  }
});
nextBtn.addEventListener('click', () => {
  savePageAnswers();
  if (!pageIsComplete()) {
    alert('Por favor, responda todas as perguntas antes de prosseguir.');
    return;
  }
  if (currentPage < totalPages - 1) {
    currentPage++;
    renderPage(currentPage);
  }
});
finishBtn.addEventListener('click', () => {
  savePageAnswers();
  if (!pageIsComplete()) {
    alert('Por favor, responda todas as perguntas antes de finalizar.');
    return;
  }
  showResults();
});

// Resultados
function showResults() {
  form.classList.add('hidden');
  prevBtn.classList.add('hidden');
  nextBtn.classList.add('hidden');
  finishBtn.classList.add('hidden');
  resultSection.classList.remove('hidden');
  resultTableBody.innerHTML = "";

  // Cálculo médias dos traços
  for (let t = 0; t < traits.length; t++) {
    let idxs = [];
    for (let i = 0; i < allQuestions.length; i++) {
      if (allQuestions[i].trait === t) idxs.push(i);
    }
    let sum = 0;
    for (let i of idxs) sum += answers[i] || 0;
    let avg = ((sum - idxs.length) / (4 * idxs.length)) * 100; // 1-5 -> 0-100
    avg = Math.round(avg);
    let tr = document.createElement('tr');
    tr.className = "hover:bg-blue-50 transition";
    let td1 = document.createElement('td');
    td1.className = "py-2 px-4";
    td1.textContent = traits[t].name;
    let td2 = document.createElement('td');
    td2.className = "py-2 px-4 text-center font-semibold text-blue-700";
    td2.textContent = avg;
    tr.appendChild(td1);
    tr.appendChild(td2);
    resultTableBody.appendChild(tr);
  }

  // Validação das perguntas de controle
  let inconsistencies = [];
  if (answers[controlQuestions[0].idx] !== 3) inconsistencies.push("Atenção: Você marcou diferente de 'Neutro' na pergunta de controle 1.");
  if (answers[controlQuestions[1].idx] === 5) inconsistencies.push("Atenção: Você marcou 'Concordo totalmente' na pergunta de controle 2, o que pode indicar resposta socialmente desejável.");
  if (answers[controlQuestions[2].idx] === 5) inconsistencies.push("Atenção: Você marcou 'Concordo totalmente' na pergunta de controle 3, o que pode indicar resposta tendenciosa.");
  if (inconsistencies.length) {
    controlWarn.innerHTML = inconsistencies.join("<br>");
    controlWarn.classList.remove('hidden');
  }
}

renderPage(0);
</script>
</body>
</html>